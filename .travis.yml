language: ruby
rvm:
  - 2.6.3
bundler_args: --without production:development
cache:
  - bundler
before_install:
  - "git clone https://github.com/zeromq/zeromq4-x libzmq \
&& cd libzmq                                        \
&& ./autogen.sh                                     \
&& ./configure --with-pgm                           \
&& make                                             \
&& sudo make install                                \
&& cd .."
  - gem update --system # travis-ci/travis-ci#8978
  - gem install bundler
  - yarn
script:
  - bundle exec rake db:create RAILS_ENV=test
  - bundle exec rake db:schema:load RAILS_ENV=test
  - bundle exec rake
  - npm test
  - npm run coveralls
